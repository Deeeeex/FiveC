# 服务器端设计文档

## 系统概述

为了实现广域网五子棋连接对战，即在不同局域网下的机器互相连接，且在不考虑内网穿透等实现手段的情况下，我们需要一个服务器端，用于对战双方数据的转发，服务器端程序部署于云服务器，用于示例的服务器IP地址为``101.34.252.176``，服务提供商为[腾讯云](https://cloud.tencent.com/)。

## 运行环境

用于示例的云服务器系统环境为``CentOS 7.6 64bit``

## 功能设计

在服务器端程序开启的情况下，会监听三个端口，``CONF_PORT``，``HOST_PORT``，``GUEST_PORT``。其中，``CONF_PORT``用于接收客户端程序的申请，另外两个端口用于建立连接，实现信息的转发。具体过程如下：

1. 客户端向服务器端发出申请，连接到``CONF_PORT``。
2. 服务器端向``CONF_PORT``发送出当前的游戏状态``Game_Status``，分为``VACANT``，``WAITING``，``ONGOING``，分别表示空闲，已有玩家等待中，以及游戏进行中。
   * 若当前为空闲，则当前申请的客户端将与``HOST_PORT``建立连接，等待另一位玩家进入游戏，并将游戏状态``Game_Status``修改为``WAITING``。
   * 若当前为等待，则当前申请的客户端将与``GUEST_PORT``建立连接，开始游戏，并将并将游戏状态``Game_Status``修改为``ONGOING``。
   * 若当前为游戏中，则断开连接，并返回信息。

3. 